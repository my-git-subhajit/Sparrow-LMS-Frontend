<div class="container" style="width: 80%; margin: 0 auto">
  <div *ngIf="!isEditing" class="h2 add-module text-grey my-3">Add Test</div>
  <div *ngIf="isEditing" class="h2 add-module text-grey my-3">Edit Test</div>
  <div class="container">
    <form (submit)="addUpdateTest()" id="formModule" [formGroup]="testForm">
      <label class="form-label text-grey" for="module-name">Test Title *</label>
      <input
        type="text"
        class="form-control form-control-lg"
        id="module-name"
        formControlName="name"
      />
      <div
        class="notValidated mb-2"
        *ngIf="testForm.get('name').invalid && testForm.get('name').touched"
      >
        Please Enter a Valid Response
      </div>
      <label for="module-description">Description*</label>
      <!-- <input type="text" class="form-control form-control-lg" id="module-description" formControlName="description" > -->
      <quill-editor
        [styles]="editorStyle"
        formControlName="description"
      ></quill-editor>
      <!-- Use Camera DIv -->
      <div class="mt-2 mb-2">
        <label for="module-useCamera mt-2 mb-2">Use Camera?*</label>
        <div class="container ml-4">
          <div class="yes">
            <input
              type="radio"
              id="useCameraYes"
              class="form-check-input"
              [value]="true"
              formControlName="useCamera"
            />
            <label class="form-check-label" for="useCameraYes">Yes</label>
          </div>
          <div class="no">
            <input
              type="radio"
              id="useCameraNo"
              class="form-check-input"
              [value]="false"
              formControlName="useCamera"
            />
            <label class="form-check-label" for="useCameraNo">No</label>
          </div>
        </div>
      </div>
      <!-- Test Type -->
      <div class="mt-2 mb-2">
        <label for="module-testType mt-2 mb-2">Test Type *</label>
        <div class="container ml-4">
          <div class="yes">
            <input
              type="radio"
              id="testTypeGrand"
              class="form-check-input"
              value="grand"
              formControlName="testType"
            />
            <label class="form-check-label" for="testTypeGrand"
              >Grand Test</label
            >
          </div>
          <div class="no">
            <input
              type="radio"
              id="testTypeMock"
              class="form-check-input"
              value="mock"
              formControlName="testType"
            />
            <label class="form-check-label" for="testTypeMock">Mock Test</label>
          </div>
        </div>
      </div>
      <!-- <input type="text" class="form-control form-control-lg" id="module-description" formControlName="description" > -->
      <div
        class="notValidated mb-2"
        *ngIf="
          testForm.get('description').invalid &&
          testForm.get('description').touched
        "
      >
        Please Enter a Valid Response
      </div>
      <label>Instructions*</label>
      <!-- <input type="text" class="form-control form-control-lg" id="module-description" formControlName="description" > -->
      <quill-editor
        [styles]="editorStyle"
        formControlName="instructions"
      ></quill-editor>
      <div
        class="notValidated mb-2"
        *ngIf="
          testForm.get('instructions').invalid &&
          testForm.get('instructions').touched
        "
      >
        Please Enter a Valid Response
      </div>

      <div class="ml-3 mt-3" formGroupName="length">
        <label>Length*</label>
        <div class="row">
          <input
            type="number"
            class="form-control form-control"
            id="hours"
            formControlName="hours"
            style="width: 25%"
          />
          <label class="ml-2 mt-1">Hours</label>
          <input
            type="number"
            class="form-control form-control ml-4"
            id="minutes"
            formControlName="minutes"
            style="width: 25%"
          />
          <label class="ml-2 mt-1">Minutes</label>
        </div>
      </div>
      <div
        class="sections-container"
        cdkDropList
        (cdkDropListDropped)="
          drop($event, getFormArray(testForm.get('sections')))
        "
      >
        <div
          formArrayName="sections"
          *ngFor="let line of getSectionsControls(); let i = index"
          id="accordion-section"
        >
          <div cdkDrag class="card lesson-card p-4 mt-4">
            <div
              class="container-fluid"
              id="headingSection"
              data-toggle="collapse"
              [attr.data-target]="'#collapse' + i"
              aria-expanded="false"
              aria-controls="collapseTwo"
            >
              <div class="row justify-content-between">
                <i
                  class="material-icons curser-drop"
                  style="color: white"
                  cdkDragHandle
                  >reorder</i
                >
                <div class="h3 col-10 text-grey">Section {{ i + 1 }}</div>
                <div class="h3 col-1 text-grey">
                  <i
                    *ngIf="i != 0"
                    (click)="deleteSection(i)"
                    class="bi bi-trash-fill ml-auto grey f-24"
                  ></i>
                </div>
                <div>
                  <i
                    class="bi bi-caret-down-fill ml-auto mt-3"
                    style="color: white"
                  ></i>
                </div>
              </div>
            </div>
            <div
              [id]="'collapse' + i"
              class="collapse"
              aria-labelledby="headingSection"
              data-parent="#accordion-section"
            >
              <form [formGroupName]="i">
                <label class="form-label text-grey" for="lesson-name">
                  Section Title*
                </label>
                <input
                  #lessonName
                  type="text"
                  class="form-control form-control-lg"
                  id="lesson-name"
                  formControlName="name"
                />
                <div
                  class="notValidated mb-2"
                  *ngIf="line.get('name').invalid && line.get('name').touched"
                >
                  Please Enter a Valid Response
                </div>
                <label for="lesson-description">Description</label>
                <!-- <input type="text" class="form-control form-control-lg" id="lesson-description" formControlName="description" > -->
                <quill-editor
                  #quill
                  [styles]="editorStyle"
                  placeholder="Enter Text"
                  formControlName="description"
                ></quill-editor>

                <div class="ml-3">
                  <div class="h-5 text-grey">Questions</div>
                  <div class="ml-4 mt-3">
                    <input
                      type="radio"
                      id="{{ 'form' + i }}"
                      class="form-check-input"
                      value="form"
                      formControlName="questionsInputType"
                      (change)="changeQuestionInputType(line)"
                    />
                    <label class="form-check-label" for="{{ 'form' + i }}"
                      >Form</label
                    >
                  </div>
                  <div class="ml-4">
                    <input
                      type="radio"
                      id="{{ 'excel' + i }}"
                      class="form-check-input"
                      value="excel"
                      formControlName="questionsInputType"
                      (change)="changeQuestionInputType(line)"
                    />
                    <label class="form-check-label" for="{{ 'excel' + i }}"
                      >Bulk Upload</label
                    >
                  </div>
                  <ng-container
                    *ngIf="line.get('questionsInputType').value == 'excel'"
                  >
                    <div class="card lesson-card p-4 mt-4">
                      <label class="form-label" for=""
                        >Please Upload Excel File</label
                      >
                      <span class="font-grey ml-3"
                        ><a
                          href="https://sparrowcodinglabs.s3.ap-south-1.amazonaws.com/1690657670489LMS.xlsx"
                          >(Click here to see Sample File)</a
                        ></span
                      >
                      <app-upload
                        [control]="getFormControl(line.get('questionsLink'))"
                      ></app-upload>
                      <div
                        class="notValidated mb-2"
                        *ngIf="
                          line.get('questionsLink').invalid &&
                          line.get('questionsLink').touched
                        "
                      >
                        Please Enter a Valid Response
                      </div>
                    </div>
                  </ng-container>
                  <ng-container
                    *ngIf="line.get('questionsInputType').value == 'form'"
                  >
                    <div
                      class="questions-container"
                      cdkDropList
                      (cdkDropListDropped)="
                        drop($event, getFormArray(line.get('questions')))
                      "
                    >
                      <div
                        formArrayName="questions"
                        *ngFor="
                          let queCtrls of getQuestionsControls(line);
                          let j = index
                        "
                        id="accordion-question"
                      >
                        <div cdkDrag class="card lesson-card p-4 mt-4">
                          <div
                            class="container-fluid"
                            id="headingQuestion"
                            data-toggle="collapse"
                            [attr.data-target]="'#collapse-question-' + i + j"
                            aria-expanded="false"
                            aria-controls="collapseTwo"
                          >
                            <div class="row justify-content-between">
                              <div class="col-1">
                                <i
                                  class="material-icons curser-drop"
                                  style="color: white"
                                  cdkDragHandle
                                  >reorder</i
                                >
                              </div>
                              <div class="col-8 h4 text-grey">
                                Question {{ j + 1 }}
                              </div>
                              <div class="col-1 text-grey mr-2">
                                <i
                                  *ngIf="j != 0"
                                  (click)="deleteQuestion(line, j)"
                                  class="bi bi-trash-fill ml-auto grey f-24"
                                ></i>
                              </div>
                              <div class="col-1">
                                <i
                                  class="bi bi-caret-down-fill ml-auto mt-3"
                                  style="color: white"
                                ></i>
                              </div>
                            </div>
                          </div>
                          <div
                            [id]="'collapse-question-' + i + j"
                            class="collapse"
                            aria-labelledby="headingQuestion"
                            data-parent="#accordion-question"
                          >
                            <form [formGroupName]="j">
                              <div class="form-label text-grey">
                                Question Type*
                              </div>
                              <div class="ml-4 mb-4">
                                <div>
                                  <input
                                    type="radio"
                                    id="{{ 'maq' + i + j }}"
                                    class="form-check-input"
                                    value="maq"
                                    formControlName="queType"
                                    (change)="
                                      questionValidationsChange(queCtrls)
                                    "
                                  />
                                  <label
                                    class="form-check-label"
                                    for="{{ 'maq' + i + j }}"
                                    >MAQ</label
                                  >
                                </div>
                                <div>
                                  <input
                                    type="radio"
                                    id="{{ 'mcq' + i + j }}"
                                    class="form-check-input"
                                    value="mcq"
                                    formControlName="queType"
                                    (change)="
                                      questionValidationsChange(queCtrls)
                                    "
                                  />
                                  <label
                                    class="form-check-label"
                                    for="{{ 'mcq' + i + j }}"
                                    >MCQ</label
                                  >
                                </div>
                                <div>
                                  <input
                                    type="radio"
                                    id="{{ 'coding' + i + j }}"
                                    class="form-check-input"
                                    value="coding"
                                    formControlName="queType"
                                    (change)="
                                      questionValidationsChange(queCtrls)
                                    "
                                  />
                                  <label
                                    class="form-check-label"
                                    for="{{ 'coding' + i + j }}"
                                    >Coding</label
                                  >
                                </div>
                                <div>
                                  <input
                                    type="radio"
                                    id="{{ 'truefalse' + i + j }}"
                                    class="form-check-input"
                                    value="truefalse"
                                    formControlName="queType"
                                    (change)="
                                      questionValidationsChange(queCtrls)
                                    "
                                  />
                                  <label
                                    class="form-check-label"
                                    for="{{ 'truefalse' + i + j }}"
                                    >True / False</label
                                  >
                                </div>
                              </div>
                              <div class="form-label text-grey">
                                Question Title Type*
                              </div>
                              <div class="ml-4 mb-4">
                                <div>
                                  <input
                                    type="radio"
                                    id="{{ 'text' + i + j }}"
                                    class="form-check-input"
                                    value="text"
                                    formControlName="questionTitleType"
                                  />
                                  <label
                                    class="form-check-label"
                                    for="{{ 'text' + i + j }}"
                                    >Text</label
                                  >
                                </div>
                                <div>
                                  <input
                                    type="radio"
                                    id="{{ 'photo' + i + j }}"
                                    class="form-check-input"
                                    value="photo"
                                    formControlName="questionTitleType"
                                  />
                                  <label
                                    class="form-check-label"
                                    for="{{ 'photo' + i + j }}"
                                    >Photo</label
                                  >
                                </div>
                              </div>
                              <label class="form-label" for=""
                                >Question Name*</label
                              >
                              <ng-container
                                *ngIf="
                                  queCtrls?.get('questionTitleType')?.value ==
                                  'text'
                                "
                              >
                                <input
                                  type="text"
                                  class="form-control form-control-lg"
                                  formControlName="questionTitle"
                                />
                              </ng-container>
                              <ng-container
                                *ngIf="
                                  queCtrls?.get('questionTitleType')?.value ==
                                  'photo'
                                "
                              >
                                <div class="mt-3 mb-3 ml-2">
                                  <app-upload
                                    [control]="
                                      getFormControl(
                                        queCtrls.get('questionTitle')
                                      )
                                    "
                                  ></app-upload>
                                </div>
                              </ng-container>
                              <div
                                class="notValidated mb-2"
                                *ngIf="
                                  queCtrls.get('questionTitle').invalid &&
                                  queCtrls.get('questionTitle').touched
                                "
                              >
                                Please Enter a Valid Response
                              </div>
                              <label class="form-label" for=""
                                >Question Description</label
                              >
                              <quill-editor
                                #quill
                                [styles]="editorStyle"
                                placeholder="Enter Text"
                                formControlName="questionDescripton"
                              ></quill-editor>
                              <ng-container
                                *ngIf="
                                  queCtrls.get('queType').value === 'coding'
                                "
                              >
                                <label class="form-label" for=""
                                  >Sample Test Cases*</label
                                >
                                <span class="font-grey ml-3"
                                  ><a
                                    href="https://xyz332211.s3.ap-south-1.amazonaws.com/Book2.xlsx"
                                    >(Click here to see Sample File)</a
                                  ></span
                                >
                                <app-upload
                                  [control]="
                                    getFormControl(
                                      queCtrls.get('sampleTestCases')
                                    )
                                  "
                                ></app-upload>
                                <div
                                  class="notValidated mb-2"
                                  *ngIf="
                                    queCtrls.get('sampleTestCases').invalid &&
                                    queCtrls.get('sampleTestCases').touched
                                  "
                                >
                                  Please Enter a Valid Response
                                </div>
                                <!-- <input
                            type="text"
                            class="form-control form-control-lg"
                            formControlName="inputTestCases"
                            /> -->
                                <!-- <label class="form-label" for="">Output Test Cases</label>
                            <app-upload [control]="getFormControl(queCtrls.get('outputTestCases'))"></app-upload> -->
                                <!-- <input
                            type="text"
                            class="form-control form-control-lg"
                            formControlName="outputTestCases"
                            /> -->
                              </ng-container>
                              <ng-container
                                *ngIf="
                                  queCtrls.get('queType').value === 'coding'
                                "
                              >
                                <label class="form-label" for=""
                                  >Test Cases*</label
                                >
                                <span class="font-grey ml-3"
                                  ><a
                                    href="https://xyz332211.s3.ap-south-1.amazonaws.com/Book2.xlsx"
                                    >(Click here to see Sample File)</a
                                  ></span
                                >
                                <app-upload
                                  [control]="
                                    getFormControl(
                                      queCtrls.get('inputTestCases')
                                    )
                                  "
                                ></app-upload>
                                <div
                                  class="notValidated mb-2"
                                  *ngIf="
                                    queCtrls.get('inputTestCases').invalid &&
                                    queCtrls.get('inputTestCases').touched
                                  "
                                >
                                  Please Enter a Valid Response
                                </div>
                                <!-- <input
                            type="text"
                            class="form-control form-control-lg"
                            formControlName="inputTestCases"
                            /> -->
                                <!-- <label class="form-label" for="">Output Test Cases</label>
                            <app-upload [control]="getFormControl(queCtrls.get('outputTestCases'))"></app-upload> -->
                                <!-- <input
                            type="text"
                            class="form-control form-control-lg"
                            formControlName="outputTestCases"
                            /> -->
                              </ng-container>
                              <ng-container
                                *ngIf="queCtrls.get('queType').value === 'maq'"
                              >
                                <label class="form-label" for=""
                                  >Option 1*</label
                                >
                                <input
                                  type="text"
                                  class="form-control form-control-lg"
                                  formControlName="option1"
                                />
                                <div
                                  class="notValidated mb-2"
                                  *ngIf="
                                    queCtrls.get('option1').invalid &&
                                    queCtrls.get('option1').touched
                                  "
                                >
                                  Please Enter a Valid Response
                                </div>
                                <div class="ml-4 mb-3">
                                  <input
                                    type="checkbox"
                                    id="{{ 'opt1' + i + j }}"
                                    class="form-check-input"
                                    [value]="true"
                                    formControlName="option1Correct"
                                  />
                                  <label
                                    class="form-check-label"
                                    for="{{ 'opt1' + i + j }}"
                                    >is option 1 correct?*</label
                                  >
                                </div>
                                <label class="form-label" for=""
                                  >Option 2*</label
                                >
                                <input
                                  type="text"
                                  class="form-control form-control-lg"
                                  formControlName="option2"
                                />
                                <div
                                  class="notValidated mb-2"
                                  *ngIf="
                                    queCtrls.get('option2').invalid &&
                                    queCtrls.get('option2').touched
                                  "
                                >
                                  Please Enter a Valid Response
                                </div>
                                <div class="ml-4 mb-3">
                                  <input
                                    type="checkbox"
                                    id="{{ 'opt2' + i + j }}"
                                    class="form-check-input"
                                    [value]="true"
                                    formControlName="option2Correct"
                                  />
                                  <label
                                    class="form-check-label"
                                    for="{{ 'opt2' + i + j }}"
                                    >is option 2 correct?*</label
                                  >
                                </div>
                                <label class="form-label" for=""
                                  >Option 3</label
                                >
                                <input
                                  type="text"
                                  class="form-control form-control-lg"
                                  formControlName="option3"
                                />
                                <div
                                  class="notValidated mb-2"
                                  *ngIf="
                                    queCtrls.get('option3').invalid &&
                                    queCtrls.get('option3').touched
                                  "
                                >
                                  Please Enter a Valid Response
                                </div>
                                <div class="ml-4 mb-3">
                                  <input
                                    type="checkbox"
                                    id="{{ 'opt3' + i + j }}"
                                    class="form-check-input"
                                    [value]="true"
                                    formControlName="option3Correct"
                                  />
                                  <label
                                    class="form-check-label"
                                    for="{{ 'opt3' + i + j }}"
                                    >is option 3 correct?*</label
                                  >
                                </div>
                                <label class="form-label" for=""
                                  >Option 4</label
                                >
                                <input
                                  type="text"
                                  class="form-control form-control-lg"
                                  formControlName="option4"
                                />
                                <div
                                  class="notValidated mb-2"
                                  *ngIf="
                                    queCtrls.get('option4').invalid &&
                                    queCtrls.get('option4').touched
                                  "
                                >
                                  Please Enter a Valid Response
                                </div>
                                <div class="ml-4">
                                  <input
                                    type="checkbox"
                                    id="{{ 'opt4' + i + j }}"
                                    class="form-check-input"
                                    [value]="true"
                                    formControlName="option4Correct"
                                  />
                                  <label
                                    class="form-check-label"
                                    for="{{ 'opt4' + i + j }}"
                                    >is option 4 correct?*</label
                                  >
                                </div>
                              </ng-container>
                              <ng-container
                                *ngIf="
                                  queCtrls.get('queType').value === 'truefalse'
                                "
                              >
                                <div class="ml-4 mb-3">
                                  <!-- <input
                              type="checkbox"
                              id="{{ 'truefalse' + i+j }}"
                              class="form-check-input"
                              [value]="true"
                              formControlName="option1Correct"
                            />
                            <label class="form-check-label" for="{{ 'truefalse' + i+j }}"
                              >Select if answer is true</label
                            > -->
                                  <div>
                                    <input
                                      type="radio"
                                      id="{{ 'true' + i + j }}"
                                      class="form-check-input"
                                      [value]="true"
                                      formControlName="option1Correct"
                                    />
                                    <label
                                      class="form-check-label"
                                      for="{{ 'true' + i + j }}"
                                      >True</label
                                    >
                                  </div>
                                  <div>
                                    <input
                                      type="radio"
                                      id="{{ 'false' + i + j }}"
                                      class="form-check-input"
                                      [value]="false"
                                      formControlName="option1Correct"
                                    />
                                    <label
                                      class="form-check-label"
                                      for="{{ 'false' + i + j }}"
                                      >False</label
                                    >
                                  </div>
                                </div>
                              </ng-container>
                              <ng-container
                                *ngIf="queCtrls.get('queType').value === 'mcq'"
                              >
                                <!-- <input
                              type="checkbox"
                              id="{{ 'truefalse' + i+j }}"
                              class="form-check-input"
                              [value]="true"
                              formControlName="option1Correct"
                            />
                            <label class="form-check-label" for="{{ 'truefalse' + i+j }}"
                              >Select if answer is true</label
                            > -->
                                <label class="form-label" for=""
                                  >Option 1*</label
                                >
                                <input
                                  type="text"
                                  class="form-control form-control-lg"
                                  formControlName="option1"
                                />
                                <div
                                  class="notValidated mb-2"
                                  *ngIf="
                                    queCtrls.get('option1').invalid &&
                                    queCtrls.get('option1').touched
                                  "
                                >
                                  Please Enter a Valid Response
                                </div>
                                <label class="form-label" for=""
                                  >Option 2*</label
                                >
                                <input
                                  type="text"
                                  class="form-control form-control-lg"
                                  formControlName="option2"
                                />
                                <div
                                  class="notValidated mb-2"
                                  *ngIf="
                                    queCtrls.get('option2').invalid &&
                                    queCtrls.get('option2').touched
                                  "
                                >
                                  Please Enter a Valid Response
                                </div>
                                <label class="form-label" for=""
                                  >Option 3</label
                                >
                                <input
                                  type="text"
                                  class="form-control form-control-lg"
                                  formControlName="option3"
                                />
                                <div
                                  class="notValidated mb-2"
                                  *ngIf="
                                    queCtrls.get('option3').invalid &&
                                    queCtrls.get('option3').touched
                                  "
                                >
                                  Please Enter a Valid Response
                                </div>
                                <label class="form-label" for=""
                                  >Option 4</label
                                >
                                <input
                                  type="text"
                                  class="form-control form-control-lg"
                                  formControlName="option4"
                                />
                                <div
                                  class="notValidated mb-2"
                                  *ngIf="
                                    queCtrls.get('option4').invalid &&
                                    queCtrls.get('option4').touched
                                  "
                                >
                                  Please Enter a Valid Response
                                </div>
                                <div class="form-label text-grey">
                                  Select Correct Option*
                                </div>
                                <div class="ml-4 mb-3">
                                  <div>
                                    <input
                                      type="radio"
                                      id="{{ 'mcq1' + i + j }}"
                                      class="form-check-input"
                                      [value]="1"
                                      formControlName="option1Correct"
                                    />
                                    <label
                                      class="form-check-label"
                                      for="{{ 'mcq1' + i + j }}"
                                      >Option 1</label
                                    >
                                  </div>
                                  <div>
                                    <input
                                      type="radio"
                                      id="{{ 'mcq2' + i + j }}"
                                      class="form-check-input"
                                      [value]="2"
                                      formControlName="option1Correct"
                                    />
                                    <label
                                      class="form-check-label"
                                      for="{{ 'mcq2' + i + j }}"
                                      >Option 2</label
                                    >
                                  </div>
                                  <div>
                                    <input
                                      type="radio"
                                      id="{{ 'mcq3' + i + j }}"
                                      class="form-check-input"
                                      [value]="3"
                                      formControlName="option1Correct"
                                    />
                                    <label
                                      class="form-check-label"
                                      for="{{ 'mcq3' + i + j }}"
                                      >Option 3</label
                                    >
                                  </div>
                                  <div>
                                    <input
                                      type="radio"
                                      id="{{ 'mcq4' + i + j }}"
                                      class="form-check-input"
                                      [value]="4"
                                      formControlName="option1Correct"
                                    />
                                    <label
                                      class="form-check-label"
                                      for="{{ 'mcq4' + i + j }}"
                                      >Option 4</label
                                    >
                                  </div>
                                  <!-- <div>
                                <input
                                  type="radio"
                                  id="{{ 'false' + i+j }}"
                                  class="form-check-input"
                                  [value]="false"
                                  formControlName="option1Correct"
                                />
                                <label class="form-check-label" for="{{ 'false' + i+j }}"
                                  >False</label
                                >
                              </div> -->
                                </div>
                              </ng-container>
                            </form>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row justify-content-between m-3">
                      <button
                        class="btn btn-outline-secondary"
                        type="button"
                        (click)="addQuestion(line)"
                      >
                        Add Question
                      </button>
                    </div>
                  </ng-container>
                </div>
              </form>
            </div>
          </div>
          <!-- </div> -->
        </div>
      </div>
    </form>
    <div class="container ml-2">
      <div class="row justify-content-between m-3">
        <button class="btn btn-outline-secondary" (click)="addSection()">
          Add Section
        </button>
        <button
          form="formModule"
          type="submit"
          class="btn btn-success"
          [disabled]="testForm.invalid"
        >
          <ng-container *ngIf="isEditing"> Update Test </ng-container>
          <ng-container *ngIf="!isEditing"> Add Test </ng-container>
        </button>
      </div>
    </div>
  </div>
</div>
